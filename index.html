<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
		<meta name="description" content="畅想海鲜店">
		<meta name="keywords" content="畅想海鲜店">
		<link href="https://cdn.bootcss.com/twitter-bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">
		<script src="https://cdn.bootcss.com/jquery/3.5.0/jquery.min.js"></script>
		<script src="https://cdn.bootcss.com/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
		<title>畅想海鲜店</title>
		<style>
			img{
				object-fit: cover;
				width: 100%;
				min-height: 100px;
			}
			.card img{
				height: 200px;
			}
			@font-face{
			    font-family: arial;
			    src: url(./fonts/arial.ttf);
			}
			@font-face{
			    font-family: arial Bold;
			    src: url(./fonts/arialbd.ttf);
			}
			.card-body{
				color: #F40;
				font-family: arial;
			}
			.card{
				cursor: pointer;
				margin-top: 20px;
				margin-bottom: 20px;
			}
			.card:hover{
				border: 1px solid #000;
			}
			[class*="col-"]{
				padding-right: 5px;
				padding-left: 5px;
			}
		</style>
	</head>
	<body>
		<div class="modal fade" id="picture-collection" tabindex="-1" role="dialog" aria-labelledby="exampleModalScrollableTitle" aria-hidden="true">
			<div class="modal-dialog modal-xl modal-dialog-scrollable" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalScrollableTitle">模态标题</h5>
						<button type="button" class="close" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
					</div>
					<div class="modal-body"></div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">关闭</button>
						<button type="button" class="btn btn-primary" data-dismiss="modal">确定</button>
					</div>
				</div>
			</div>
		</div>
		<div class="container-fluid">
			<div id="content" class="row" style="margin: 0px;"></div>
		</div>
		<script>
			// 数据都保存在 supplies 里，到时由ajax获取这个变量
			$.ajax({
				url:'http://111.230.49.80/commodity/getdata/',
				type: "GET",
				dataType: "jsonp",
				jsonp: "callback",
				jsonpCallback: "successCallback", //这里的值需要和回调函数名一样
				success:function(supplies){
					$.each(supplies, function(index, value){
						var name = value['name'];
						var price = value['price'];
						var imgs = value['imgs'][0]===undefined?'https://logo-1256424525.cos.ap-hongkong.myqcloud.com/%E6%9A%82%E6%97%A0%E5%9B%BE%E7%89%87.png': value['imgs'][0];
						$('#content').append('<div class="col-xl-2 col-lg-3 col-sm-6 col-6"><div class="card" data-toggle="modal" data-target="#picture-collection" data-id="'+index+'"><div class="card-header">'+name+'</div><img class="rounded" src="'+imgs+'" alt="'+name+'" /><div class="card-body"><h5 class="card-title"><span></span><span class="price">'+price+'</span></h5></div></div></div>')
					});
					$('#picture-collection').on('show.bs.modal', function(event){
						$(this).find('.modal-body').html('');
						var element = $(event.relatedTarget);
						var name = element.find('.card-header').text();
						var imgs = supplies[element.data('id')]['imgs'];
						$(this).find('.modal-title').text(name)
						for(let i=0;i<imgs.length;i++){
							$(this).find('.modal-body').append('<img class="img-thumbnail" width="100%" src="'+imgs[i]+'" alt="'+name+'" />');
						}
					});
				},
				error:function (textStatus){ //请求失败后调用的函数
					console.log(JSON.stringify(textStatus));
				}
			});
		</script>
		<div class="w-100" align="right" style="display: none;">
			<script type="text/javascript" src="https://s4.cnzz.com/z_stat.php?id=1278874207&web_id=1278874207"></script>
		</div>
	</body>
</html>